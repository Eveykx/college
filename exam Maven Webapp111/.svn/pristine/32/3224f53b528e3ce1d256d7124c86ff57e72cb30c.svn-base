package cn.edu.nenu.clzc.dao.examination;

import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import cn.edu.nenu.clzc.commons.core.AbstractDao;
import cn.edu.nenu.clzc.commons.core.expandhandler.ExpandBeanListHandler;
import cn.edu.nenu.clzc.commons.entites.examination.ParamUnit;
import cn.edu.nenu.clzc.commons.enumeration.exception.DaoExceptionEnum;
import cn.edu.nenu.clzc.commons.exception.ContextException;
import cn.edu.nenu.clzc.commons.vo.examination.ParamUintVo;

/**
* @ClassName: ParamUnitDao
* @Description: 单元操作dao层(这里用一句话描述这个类的作用)
* @author Kyrie Irving
* @date 2016年11月29日 下午12:32:38
 */


public class ParamUnitDao extends AbstractDao {
	/**
	* @Title: addEdition
	* @Description: 添加一个单元(这里用一句话描述这个方法的作用)
	* @author Kyrie Irving
	* @param @param ParamEdition
	* @param @return
	* @param @throws Exception    设定文件
	* @return String    返回类型
	* @throws
	 */
	public String addUnit(ParamUnit ParamUnit) throws Exception {
		String id = ParamUnit.getId();  
		String unitName = ParamUnit.getUnitName();
		String unitInfo = ParamUnit.getUnitInfo();
		Date unitTime = ParamUnit.getUnitTime();
		String editonId = ParamUnit.getEditionId();
		
		Object[] params = {id, unitName, unitInfo, unitTime,editonId};
		String sql = "INSERT INTO param_unit (id , unit_name , unit_info , edition_id , unit_time ) VALUES (?, ?, ?, ?, ?)";
		String au = null;
		try {
			au = insert(sql, params);
		} catch (ContextException | SQLException e) {
			logger.error(DaoExceptionEnum.AddUnitFaild.getInfo(),e);
			throw new Exception(DaoExceptionEnum.AddUnitFaild.getInfo());
		}
		return au;
	}
	
	/**
	* @Title: updateEdition
	* @Description: 通过修改ID来控制一个单元的显示状态(这里用一句话描述这个方法的作用)
	* @author Kyrie Irving
	* @param @param id
	* @param @param editionIsDelete
	* @param @return
	* @param @throws Exception    设定文件
	* @return int    返回类型
	* @throws
	 */
	public int updateUNit(String id,String unitIsDelete) throws Exception {
		Object[] params = {unitIsDelete,id};
		String sql = "UPDATE param_unit SET unit_id_delete =? WHERE  id = ?" ;
		int xu = 0;
		try {
			xu = update(sql, params);
		} catch (ContextException e) {
			logger.error(DaoExceptionEnum.UpdateUnitFaild.getInfo(),e);
			throw new Exception(DaoExceptionEnum.UpdateUnitFaild.getInfo());
		}
		return xu;
	}

	
	/**
	* @Title: selectByEditionName
	* @Description: 根据单元名来查找单元(这里用一句话描述这个方法的作用)
	* @author Kyrie Irving
	* @param @param editionName
	* @param @param currentPage
	* @param @return
	* @param @throws Exception    设定文件
	* @return List<ParamEditionVo>    返回类型
	* @throws
	 */
	public List<ParamUintVo> selectByUnitName(String unitName, int currentPage) throws Exception {
		List<ParamUintVo> list = new ArrayList<ParamUintVo>();
		String sql = "SELECT param_unit.unit_name,	param_unit.unit_info,	param_unit.unit_time,	param_unit.edition_id FROM param_unit WHERE	param_unit.unit_is_delete !=1 AND param_unit.edition_id=1 ORDER BY param_unit.edition_id";
		Object[] params = {"%"+unitName+"%", (currentPage-1)*PAGESIZE, PAGESIZE};
		try {
			list = query(sql, new ExpandBeanListHandler<ParamUintVo>(ParamUintVo.class), params);
		} catch (ContextException e) {
			logger.error(DaoExceptionEnum.SelectUnitByUnitNameFaild.getInfo(),e);
			throw new Exception(DaoExceptionEnum.SelectUnitByUnitNameFaild.getInfo());
		}
		return list;
	}

	
}
